# 权限测试用例文档

## 1. 测试目的

验证系统的权限管理机制是否正常工作，确保不同角色的用户只能执行其权限范围内的操作，防止越权行为。

## 2. 测试环境

- 后端服务地址：http://localhost:5000
- 前端服务地址：http://localhost:3000
- 测试账号：
  - 管理员：username=admin, password=admin123, role=admin
  - 组长：username=leader, password=leader123, role=leader
  - 组员：username=member, password=member123, role=member

## 3. 角色权限定义

| 功能模块 | 管理员 | 组长 | 组员 |
|---------|--------|------|------|
| 表格定义 | ✅ | ❌ | ❌ |
| 表格管理 | ✅ | ❌ | ❌ |
| 数据添加 | ✅ | ✅ | ✅ |
| 数据编辑 | ✅ | ✅ | ❌ |
| 数据删除 | ✅ | ✅ | ❌ |
| 数据导入 | ✅ | ✅ | ❌ |
| 数据导出 | ✅ | ✅ | ✅ |
| 数据统计 | ✅ | ✅ | ✅ |

## 4. 测试用例

### 4.1 管理员权限测试

| 用例ID | 测试功能 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|--------|----------|----------|----------|----------|----------|
| TC_PERM_ADMIN_001 | 表格定义 | 1. 管理员登录<br>2. 点击"表格定义"菜单 | 显示表格定义页面，可进行表格创建、编辑、删除操作 | | |
| TC_PERM_ADMIN_002 | 表格管理 | 1. 管理员登录<br>2. 点击"已定义表格"菜单 | 显示已定义表格列表，可进行编辑、删除操作 | | |
| TC_PERM_ADMIN_003 | 数据添加 | 1. 管理员登录<br>2. 选择一个表格<br>3. 点击"添加数据"按钮<br>4. 填写表单并提交 | 数据添加成功 | | |
| TC_PERM_ADMIN_004 | 数据编辑 | 1. 管理员登录<br>2. 选择一个表格<br>3. 点击某条数据的"编辑"按钮<br>4. 修改数据并提交 | 数据编辑成功 | | |
| TC_PERM_ADMIN_005 | 数据删除 | 1. 管理员登录<br>2. 选择一个表格<br>3. 点击某条数据的"删除"按钮<br>4. 确认删除 | 数据删除成功 | | |
| TC_PERM_ADMIN_006 | 数据导入 | 1. 管理员登录<br>2. 选择一个表格<br>3. 点击"导入数据"按钮<br>4. 上传CSV文件并提交 | 数据导入成功 | | |
| TC_PERM_ADMIN_007 | 数据导出 | 1. 管理员登录<br>2. 选择一个表格<br>3. 点击"导出数据"按钮 | 数据导出成功 | | |
| TC_PERM_ADMIN_008 | 数据统计 | 1. 管理员登录<br>2. 选择一个表格<br>3. 点击"统计分析"按钮 | 显示数据统计图表 | | |

### 4.2 组长权限测试

| 用例ID | 测试功能 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|--------|----------|----------|----------|----------|----------|
| TC_PERM_LEADER_001 | 表格定义 | 1. 组长登录<br>2. 点击"表格定义"菜单 | 无权限访问，显示403错误或隐藏菜单 | | |
| TC_PERM_LEADER_002 | 表格管理 | 1. 组长登录<br>2. 点击"已定义表格"菜单 | 无权限访问，显示403错误或隐藏菜单 | | |
| TC_PERM_LEADER_003 | 数据添加 | 1. 组长登录<br>2. 选择一个表格<br>3. 点击"添加数据"按钮<br>4. 填写表单并提交 | 数据添加成功 | | |
| TC_PERM_LEADER_004 | 数据编辑 | 1. 组长登录<br>2. 选择一个表格<br>3. 点击某条数据的"编辑"按钮<br>4. 修改数据并提交 | 数据编辑成功 | | |
| TC_PERM_LEADER_005 | 数据删除 | 1. 组长登录<br>2. 选择一个表格<br>3. 点击某条数据的"删除"按钮<br>4. 确认删除 | 数据删除成功 | | |
| TC_PERM_LEADER_006 | 数据导入 | 1. 组长登录<br>2. 选择一个表格<br>3. 点击"导入数据"按钮<br>4. 上传CSV文件并提交 | 数据导入成功 | | |
| TC_PERM_LEADER_007 | 数据导出 | 1. 组长登录<br>2. 选择一个表格<br>3. 点击"导出数据"按钮 | 数据导出成功 | | |
| TC_PERM_LEADER_008 | 数据统计 | 1. 组长登录<br>2. 选择一个表格<br>3. 点击"统计分析"按钮 | 显示数据统计图表 | | |

### 4.3 组员权限测试

| 用例ID | 测试功能 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|--------|----------|----------|----------|----------|----------|
| TC_PERM_MEMBER_001 | 表格定义 | 1. 组员登录<br>2. 点击"表格定义"菜单 | 无权限访问，显示403错误或隐藏菜单 | | |
| TC_PERM_MEMBER_002 | 表格管理 | 1. 组员登录<br>2. 点击"已定义表格"菜单 | 无权限访问，显示403错误或隐藏菜单 | | |
| TC_PERM_MEMBER_003 | 数据添加 | 1. 组员登录<br>2. 选择一个表格<br>3. 点击"添加数据"按钮<br>4. 填写表单并提交 | 数据添加成功 | | |
| TC_PERM_MEMBER_004 | 数据编辑 | 1. 组员登录<br>2. 选择一个表格<br>3. 检查是否有"编辑"按钮 | 无"编辑"按钮或点击后显示403错误 | | |
| TC_PERM_MEMBER_005 | 数据删除 | 1. 组员登录<br>2. 选择一个表格<br>3. 检查是否有"删除"按钮 | 无"删除"按钮或点击后显示403错误 | | |
| TC_PERM_MEMBER_006 | 数据导入 | 1. 组员登录<br>2. 选择一个表格<br>3. 检查是否有"导入数据"按钮 | 无"导入数据"按钮或点击后显示403错误 | | |
| TC_PERM_MEMBER_007 | 数据导出 | 1. 组员登录<br>2. 选择一个表格<br>3. 点击"导出数据"按钮 | 数据导出成功 | | |
| TC_PERM_MEMBER_008 | 数据统计 | 1. 组员登录<br>2. 选择一个表格<br>3. 点击"统计分析"按钮 | 显示数据统计图表 | | |

## 5. 边界测试用例

| 用例ID | 测试功能 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|--------|----------|----------|----------|----------|----------|
| TC_BOUNDARY_001 | 越权API访问 | 1. 组员登录获取token<br>2. 使用该token直接调用删除数据API | 返回403错误 | | |
| TC_BOUNDARY_002 | 权限缓存测试 | 1. 管理员登录<br>2. 修改某用户角色<br>3. 该用户重新登录<br>4. 验证新角色权限 | 应用新角色权限 | | |
| TC_BOUNDARY_003 | 无token访问 | 1. 直接访问需要权限的API | 返回401错误 | | |

## 6. 安全性测试用例

| 用例ID | 测试功能 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|--------|----------|----------|----------|----------|----------|
| TC_SEC_001 | SQL注入防护 | 1. 在数据添加表单中输入SQL注入语句<br>2. 提交表单 | 系统拒绝该请求或正确处理，不执行恶意SQL | | |
| TC_SEC_002 | XSS防护 | 1. 在数据添加表单中输入XSS脚本<br>2. 提交表单<br>3. 查看该数据 | 系统拒绝该请求或正确转义，不执行恶意脚本 | | |
| TC_SEC_003 | 密码安全性 | 1. 尝试使用弱密码登录<br>2. 查看密码存储方式 | 拒绝弱密码，密码加密存储 | | |

## 7. 测试执行说明

1. 按照测试用例顺序执行，记录实际结果
2. 对于每个测试用例，标记测试状态（通过/失败）
3. 对于失败的测试用例，详细记录错误信息和复现步骤
4. 测试完成后，生成测试报告，包括通过率、失败原因分析和改进建议

## 8. 测试工具

- 浏览器开发者工具
- Postman（用于API测试）
- Playwright（用于自动化测试）

## 9. 测试完成标准

1. 所有测试用例执行完毕
2. 测试结果记录完整
3. 生成测试报告
4. 修复所有严重级别的权限漏洞

## 10. 测试报告模板

| 测试项目 | 测试用例数 | 通过数 | 失败数 | 通过率 |
|----------|------------|--------|--------|--------|
| 管理员权限 | 8 | | | |
| 组长权限 | 8 | | | |
| 组员权限 | 8 | | | |
| 边界测试 | 3 | | | |
| 安全性测试 | 3 | | | |
| 总计 | 30 | | | |

## 11. 后续流程

1. 测试完成后，根据测试报告修复权限漏洞
2. 重新执行失败的测试用例，确保修复有效
3. 最终生成正式的权限测试报告，归档保存