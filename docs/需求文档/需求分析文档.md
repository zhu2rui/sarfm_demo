# 实验室多端Web库存管理系统 - 需求分析文档

## 1. 项目概述

### 1.1 产品愿景
为生物实验室提供一个灵活、易用的多端Web库存管理系统，支持自定义表格结构，实现库存的高效管理和查询，提升实验室库存管理的规范化和效率。

### 1.2 项目背景
当前生物实验室（主要研究免疫方向）的库存管理（如引物、质粒、试剂等）缺乏一个统一、灵活的系统，导致库存信息不清晰、管理效率低下。需要一个支持自定义表格结构的Web系统，以便根据实验室的实际需求灵活管理不同类型的库存信息。

### 1.3 目标用户
- **管理员**：实验室负责人或指定的系统管理员，负责系统的全面管理和配置
- **组长**：实验室小组负责人，负责小组内库存数据的管理
- **组员**：实验人员，负责库存数据的上传和查询

### 1.4 成功指标
- 系统上线时间：5天内完成开发和部署
- 用户满意度：实验室成员对系统的易用性和功能性给予积极反馈
- 系统稳定性：基本稳定运行，无严重故障
- 功能完整性：实现所有核心功能，满足用户基本需求

## 2. 用户角色与权限

| 角色 | 权限描述 |
|------|----------|
| 管理员 | 1. 拥有所有系统权限<br>2. 定义和删除表格结构（列名、数据类型等）<br>3. 管理用户角色和权限（角色提权）<br>4. 执行所有数据操作（添加、修改、删除等）<br>5. 查看所有报表和统计信息 |
| 组长 | 1. 查看所有表格结构<br>2. 执行数据操作（添加、修改、删除）<br>3. 查看报表和统计信息<br>4. 不能删除表格类型 |
| 组员 | 1. 查看已定义的表格结构<br>2. 仅能上传/添加数据<br>3. 不能修改或删除数据<br>4. 查看库存数据 |

## 3. 功能需求

### 3.1 核心功能

#### 3.1.1 表格结构定义功能
- **功能描述**：允许管理员定义和管理库存表格的结构
- **详细需求**：
  - 支持定义总表名（需单独输入框）
  - 支持定义表格列信息，每列需包含：列名、数据类型（字符串类型）
  - 提供"添加列"功能（通过"+"按钮实现），允许用户添加多列以完成一张完整表格的定义
  - 提供表格定义的保存功能
  - 支持修改和删除已定义的表格结构（仅管理员）

#### 3.1.2 已定义表格管理功能
- **功能描述**：管理所有已定义的表格结构
- **详细需求**：
  - 在侧边栏显示所有已定义完成的表格名称列表
  - 支持点击表格名称触发操作，使数据显示区域加载并展示对应表格的数据
  - 支持表格名称的修改（仅管理员）
  - 支持表格结构的删除（仅管理员）

#### 3.1.3 库存数据管理功能
- **功能描述**：管理库存数据的增删改查
- **详细需求**：
  - 支持库存数据的入库、出库、调拨功能
  - 支持数据的添加（所有用户角色）
  - 支持数据的修改和删除（仅管理员和组长）
  - 支持按条件筛选和排序数据
  - 支持数据的批量操作（如批量导入）

#### 3.1.4 报表统计功能
- **功能描述**：提供库存统计和报表功能
- **详细需求**：
  - 支持查看一段时间内的库存消耗报表
  - 支持按不同维度（如时间、类型、人员等）生成报表
  - 报表以表格形式展示，支持导出功能

### 3.2 辅助功能

#### 3.2.1 用户认证与授权功能
- **功能描述**：确保系统的安全访问
- **详细需求**：
  - 支持用户登录和注销功能
  - 支持不同用户角色的权限控制
  - 记录用户登录日志

#### 3.2.2 系统设置功能
- **功能描述**：提供系统级别的设置和配置
- **详细需求**：
  - 支持修改系统名称和基本信息
  - 支持备份和恢复数据
  - 支持清理系统日志

### 3.3 管理功能

#### 3.3.1 用户管理功能
- **功能描述**：管理系统用户和角色
- **详细需求**：
  - 支持添加、修改、删除用户
  - 支持设置用户角色和权限
  - 支持重置用户密码

## 4. 非功能需求

### 4.1 性能需求
- 系统响应时间：页面加载时间不超过2秒，数据操作响应时间不超过1秒
- 并发用户数：支持同时10-20人在线使用
- 数据处理能力：能够处理至少10万条库存记录

### 4.2 安全需求
- 用户认证：支持用户名和密码登录认证
- 访问控制：基于角色的权限控制，确保用户只能访问和操作其权限范围内的功能
- 数据安全：数据库数据加密存储，防止未授权访问
- 日志记录：记录用户登录日志和关键操作日志

### 4.3 可用性需求
- 系统可用性：系统 uptime 不低于95%
- 故障恢复：系统故障后能够在30分钟内恢复正常运行
- 界面友好：操作界面简洁明了，用户易于学习和使用
- 错误处理：提供清晰的错误提示信息，帮助用户解决问题

### 4.4 兼容性需求
- 浏览器兼容：支持主流浏览器，包括Chrome、Firefox、Safari、Edge等
- 终端兼容：支持PC、平板、手机等不同终端设备，通过响应式设计适配不同屏幕尺寸
- 分辨率兼容：支持1024x768及以上分辨率

## 5. 数据模型

### 5.1 表格结构表（table_structures）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 表格结构ID，主键 |
| table_name | VARCHAR(255) | 总表名 |
| columns | TEXT | 列定义JSON字符串，格式：[{"column_name": "列名", "data_type": "数据类型"}...] |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

### 5.2 库存数据表（inventory_data）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 数据ID，主键 |
| table_id | INTEGER | 所属表格ID，外键关联table_structures.id |
| data | TEXT | 库存数据JSON字符串，格式：{"列名1": "值1", "列名2": "值2", ...} |
| created_by | INTEGER | 创建者ID，外键关联users.id |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

### 5.3 用户信息表（users）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 用户ID，主键 |
| username | VARCHAR(50) | 用户名 |
| password | VARCHAR(255) | 密码（加密存储） |
| role | VARCHAR(20) | 用户角色（admin/leader/member） |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

### 5.4 操作日志表（operation_logs）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 日志ID，主键 |
| user_id | INTEGER | 操作用户ID，外键关联users.id |
| operation | VARCHAR(255) | 操作描述 |
| table_id | INTEGER | 涉及的表格ID |
| data_id | INTEGER | 涉及的数据ID |
| created_at | DATETIME | 操作时间 |

## 6. 业务流程

### 6.1 表格结构定义流程
1. 管理员登录系统
2. 进入表格定义模块
3. 输入总表名
4. 添加列信息（列名和数据类型）
5. 保存表格定义
6. 系统将表格定义保存到数据库
7. 已定义表格列表更新

### 6.2 数据添加流程
1. 用户登录系统
2. 在侧边栏选择要操作的表格
3. 点击"添加数据"按钮
4. 填写数据表单
5. 提交表单
6. 系统验证数据合法性
7. 系统将数据保存到数据库
8. 数据表格更新

### 6.3 数据查询流程
1. 用户登录系统
2. 在侧边栏选择要查询的表格
3. 系统加载并显示表格数据
4. 用户可以使用筛选条件进行数据过滤
5. 用户可以使用排序功能调整数据顺序
6. 系统根据用户操作更新数据显示

### 6.4 用户登录流程
1. 用户访问系统登录页面
2. 输入用户名和密码
3. 点击登录按钮
4. 系统验证用户名和密码
5. 验证通过，用户进入系统主界面
6. 验证失败，显示错误提示

## 7. 界面设计需求

### 7.1 设计原则
- **简洁性**：界面设计简洁明了，减少不必要的元素，突出核心功能
- **一致性**：保持界面元素的一致性，包括颜色、字体、按钮样式等
- **响应式**：采用响应式设计，适配不同终端设备的屏幕尺寸
- **易用性**：操作流程简单直观，降低用户学习成本

### 7.2 主要界面

#### 7.2.1 登录界面
- **功能**：用户登录系统
- **布局**：居中的登录表单，包含用户名、密码输入框和登录按钮
- **设计**：简洁的卡片式设计，突出登录功能

#### 7.2.2 主界面
- **布局结构**：三部分结构
  1. **标题区域**：页面顶部，显示系统名称"实验室库存管理系统"
  2. **侧边栏区域**：页面左侧，包含表格定义和已定义表格列表
  3. **数据显示区域**：页面右侧，显示选中表格的数据

##### 7.2.2.1 标题区域
- **位置**：页面顶部，宽度100%
- **内容**：系统名称"实验室库存管理系统"
- **设计**：背景色为深蓝色，文字为白色，居中显示，字体大小24px，高度60px

##### 7.2.2.2 侧边栏区域
- **位置**：页面左侧，宽度250px，高度100%（减去标题区域高度）
- **内容**：
  - **表格定义模块**：
    - 模块标题："表格定义"
    - 总表名输入框：标签"总表名"，输入框（最大长度50字符）
    - 列定义区域：
      - 显示已添加的列，每列包含：
        - 列名输入框：标签"列名"，输入框（最大长度50字符）
        - 数据类型选择框：默认"字符串"类型（本系统所有数据统一使用字符串类型存储）
        - 删除按钮："×"按钮，点击删除当前列（至少保留一列）
    - "添加列"按钮："+ 添列"按钮，点击在当前列列表末尾添加新列
    - "保存表格"按钮："保存表格"按钮，点击保存当前表格定义（总表名和至少一列不能为空）
  - **已定义表格列表**：
    - 模块标题："已定义表格"
    - 表格名称列表：
      - 每个表名为可点击的链接，点击后数据显示区域加载并显示对应表格的数据
      - 表格名称右侧显示"编辑"和"删除"按钮（仅管理员可见）
      - 支持搜索和过滤功能

##### 7.2.2.3 数据显示区域
- **位置**：页面右侧，宽度100%（减去侧边栏宽度），高度100%（减去标题区域高度）
- **内容**：
  - **表格信息栏**：
    - 当前选中表格的名称（字体大小18px，加粗）
    - 数据统计信息：显示当前表格的总记录数
  - **操作工具栏**：
    - "添加数据"按钮：点击打开数据添加表单
    - "导入数据"按钮：支持批量导入数据（CSV格式）
    - "导出数据"按钮：支持导出当前表格数据（CSV格式）
    - "刷新数据"按钮：点击重新加载当前表格数据
  - **数据过滤与搜索区**：
    - 全局搜索框：支持按关键字搜索表格中的所有数据
    - 高级过滤：支持按列名设置过滤条件（如：日期范围、等于、包含等）
  - **数据表格**：
    - 显示选中表格的所有数据，列名与侧边栏定义的表格结构一致
    - 支持列宽调整和列显示/隐藏控制
    - 支持按列排序（升序/降序）
    - 支持分页显示（默认每页20条记录，可选择10/20/50/100条）
    - 支持行选择（单选/多选）
    - 每行末尾显示操作按钮：
      - 查看详情：点击查看完整数据信息
      - 编辑：点击编辑当前数据（仅管理员和组长可见）
      - 删除：点击删除当前数据（仅管理员和组长可见）
  - **批量操作栏**：
    - 当选择多行数据后显示，支持批量删除操作（仅管理员和组长可见）

## 8. 技术需求

### 8.1 技术栈
- **前端技术**：HTML5、CSS3、JavaScript、React/Vue.js（响应式框架）
- **后端技术**：Python/Node.js（轻量级Web框架，如Flask/Express）
- **数据库**：SQLite（轻量级关系型数据库）
- **部署环境**：支持Windows、Linux等操作系统，可部署在本地服务器或云服务器

### 8.2 系统架构
```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   前端界面层    │     │   后端服务层    │     │   数据存储层    │
│                 │     │                 │     │                 │
│  - 标题区域     │     │  - API接口      │     │  - 表格结构表   │
│  - 侧边栏区域   │────▶│  - 业务逻辑     │────▶│  - 库存数据表   │
│  - 数据显示区域 │     │  - 权限控制     │     │  - 用户信息表   │
│                 │     │  - 日志管理     │     │  - 操作日志表   │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

## 9. 验收标准

### 9.1 功能验收
- 所有核心功能和辅助功能都已实现
- 功能实现符合PRD文档中的需求描述
- 不同角色的权限控制正确实现

### 9.2 性能验收
- 页面加载时间不超过2秒
- 数据操作响应时间不超过1秒
- 支持同时10-20人在线使用
- 能够处理至少10万条库存记录

### 9.3 安全验收
- 用户认证功能正常
- 权限控制有效
- 数据加密存储
- 操作日志完整

### 9.4 兼容性验收
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 支持不同终端设备（PC、平板、手机）
- 支持1024x768及以上分辨率

### 9.5 可用性验收
- 界面友好，操作简单
- 错误提示清晰
- 系统稳定运行，无严重故障

## 10. 风险评估

### 10.1 技术风险
- **风险描述**：自定义表格结构功能实现复杂度较高
- **应对策略**：采用JSON格式存储表格结构和数据，简化数据库设计，使用成熟的前端框架实现动态表格渲染

### 10.2 业务风险
- **风险描述**：用户对系统的使用习惯需要时间适应
- **应对策略**：提供简洁的操作界面和使用说明，组织用户培训，及时收集用户反馈并进行优化

### 10.3 进度风险
- **风险描述**：开发时间紧张（5天），可能影响功能完整性
- **应对策略**：优先实现核心功能，确保系统可用，后续可根据需求迭代优化

## 11. 参考文档

- 《Web响应式设计最佳实践》
- 《SQLite数据库使用指南》
- 《实验室库存管理规范》