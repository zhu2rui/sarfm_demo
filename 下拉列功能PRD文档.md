# 实验室多端Web库存管理系统 - 下拉列功能PRD文档

## 1. 项目概述

### 1.1 功能背景

在现有系统中，表格列管理功能采用"隐藏列"的概念，允许用户通过配置将某些列设置为隐藏状态。为了提升用户体验和功能清晰度，现需要将该功能进行优化升级，更名为"下拉列"，并调整相关交互逻辑和UI设计，使表格数据展示更加灵活和直观。

### 1.2 功能目标

- 将原"隐藏列"功能更名为"下拉列"，明确功能语义
- 优化列定义配置界面，添加"下拉显示"复选框
- 改进表格展示规则，默认显示主要列，通过展开/收起方式显示次要列
- 提升用户体验，实现平滑过渡动画和响应式设计
- 确保与现有系统功能兼容，不影响已有数据和操作流程

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 功能概念重命名
- 将原"隐藏列"功能正式更名为"下拉列"
- 所有相关UI元素、提示文本、文档等统一使用"下拉列"术语

#### 2.1.2 列定义配置
- 在表格定义页面的列配置中，将原"隐藏"复选框替换为"下拉显示"复选框
- 每列均可独立配置是否为"下拉显示"列
- 默认状态为未勾选（即默认显示）
- 配置后的数据持久化存储

#### 2.1.3 表格展示规则
- 默认显示所有未勾选"下拉显示"的列
- 勾选"下拉显示"的列默认隐藏，需通过展开按钮显示
- 提供清晰的展开/收起按钮，位于表格头部或操作栏
- 展开/收起状态在会话期间保持，刷新页面后重置为默认状态

#### 2.1.4 交互体验
- 展开/收起操作带有平滑过渡动画
- 响应式设计，适配不同屏幕尺寸
- 移动端优化，确保在小屏幕设备上良好显示

### 2.2 辅助功能

#### 2.2.1 用户偏好记忆
- 保存用户的展开/收起状态偏好
- 支持跨设备同步用户偏好（如有必要）

#### 2.2.2 性能优化
- 下拉列数据懒加载，减少初始加载时间
- 虚拟滚动，处理大数据量场景
- 优化DOM操作，避免频繁重绘

## 3. 交互流程

### 3.1 列定义配置流程

1. **进入表格定义页面**：用户从侧边栏菜单选择"表格定义"功能
2. **选择或创建表格**：用户选择现有表格或创建新表格
3. **配置列属性**：在列定义区域，为每列配置以下属性：
   - 列名
   - 数据类型
   - 下拉显示（复选框）
4. **保存配置**：点击"保存表格"按钮，将配置持久化存储
5. **配置生效**：配置立即生效，新创建的表格或修改后的表格将按照新规则显示

### 3.2 表格数据查看流程

1. **进入数据管理页面**：用户从侧边栏菜单选择"数据管理"功能
2. **选择表格**：用户从侧边栏选择一个表格
3. **查看默认显示列**：表格默认显示所有未勾选"下拉显示"的列
4. **展开下拉列**：点击表格头部或操作栏的展开按钮，显示所有勾选"下拉显示"的列
5. **收起下拉列**：点击收起按钮，隐藏所有"下拉显示"的列，恢复默认显示状态

## 4. UI规范

### 4.1 表格定义页面

#### 4.1.1 列配置区域
- 列配置项包含：列名输入框、数据类型选择（当前为只读默认string）、下拉显示复选框
- 下拉显示复选框标签为"下拉显示"，位于数据类型右侧
- 复选框未勾选时，列默认显示在表格中
- 复选框勾选时，列默认隐藏，需通过展开按钮显示

#### 4.1.2 按钮样式
- "添加列"按钮：虚线边框，点击后添加新的列配置项
- "删除"按钮：红色文字，点击后删除当前列配置项
- "保存表格"按钮：蓝色主按钮，点击后保存配置

### 4.2 数据管理页面

#### 4.2.1 表格头部
- 表格头部右侧或操作栏中添加展开/收起按钮
- 展开按钮图标：向下箭头或展开图标
- 收起按钮图标：向上箭头或收起图标
- 按钮样式：默认按钮样式，hover状态有明显反馈

#### 4.2.2 表格主体
- 默认显示列与下拉列之间有视觉区分（可选）
- 展开/收起时有平滑过渡动画（duration: 0.3s）
- 响应式设计：
  - 桌面端：展开后所有列横向排列
  - 移动端：展开后通过滚动查看所有列，或采用其他适配方案

#### 4.2.3 列选择菜单
- 将原"隐藏列"按钮更名为"下拉列"按钮
- 菜单内容保持不变，仍包含列选择和全选功能
- 菜单样式优化，提升视觉体验

## 5. 技术要求

### 5.1 响应式布局
- 适配不同屏幕尺寸：移动端（≤768px）、平板（769px-1024px）、桌面端（≥1025px）
- 表格列宽自适应，确保在各种设备上都能良好显示
- 操作按钮在小屏幕设备上自动调整大小和布局

### 5.2 平滑动画
- 展开/收起动画：duration 0.3s，ease-in-out缓动函数
- 列显示/隐藏动画：渐入渐出效果
- 按钮状态变化动画：hover效果、点击反馈

### 5.3 性能优化
- 初始加载时只渲染默认显示列，下拉列数据懒加载
- 大数据量场景下采用虚拟滚动技术
- 优化DOM操作，减少重绘和回流
- 缓存用户偏好设置，减少网络请求

### 5.4 兼容性要求
- 兼容现有系统的所有功能和数据
- 支持主流浏览器：Chrome（最新版）、Firefox（最新版）、Safari（最新版）、Edge（最新版）
- 兼容现有用户数据，无需数据迁移

## 6. 示例场景

### 6.1 场景描述

假设我们有一个"人员信息"表格，包含以下列：
- 姓名
- 年龄
- 籍贯
- 婚姻状况
- 子女情况

### 6.2 配置示例

在表格定义页面，管理员对各列进行如下配置：
- 姓名：未勾选"下拉显示"（默认显示）
- 年龄：未勾选"下拉显示"（默认显示）
- 籍贯：未勾选"下拉显示"（默认显示）
- 婚姻状况：勾选"下拉显示"（默认隐藏）
- 子女情况：勾选"下拉显示"（默认隐藏）

### 6.3 展示效果

1. **初始状态**：表格只显示"姓名"、"年龄"、"籍贯"三列
2. **展开状态**：用户点击展开按钮后，表格显示所有五列，包括"婚姻状况"和"子女情况"
3. **收起状态**：用户点击收起按钮后，表格恢复只显示前三列

## 7. 验收标准

### 7.1 功能验收

1. **功能概念重命名**
   - [ ] 所有UI元素中"隐藏列"均已更改为"下拉列"
   - [ ] 所有相关提示文本、文档等统一使用"下拉列"术语

2. **列定义配置**
   - [ ] 表格定义页面的列配置中，"隐藏"复选框已替换为"下拉显示"复选框
   - [ ] 每列均可独立配置"下拉显示"属性
   - [ ] 配置后的数据正确持久化存储
   - [ ] 配置修改后，表格展示效果同步更新

3. **表格展示规则**
   - [ ] 默认显示所有未勾选"下拉显示"的列
   - [ ] 勾选"下拉显示"的列默认隐藏
   - [ ] 提供清晰的展开/收起按钮
   - [ ] 点击展开按钮后，所有"下拉显示"列正确显示
   - [ ] 点击收起按钮后，所有"下拉显示"列正确隐藏

4. **交互体验**
   - [ ] 展开/收起操作带有平滑过渡动画
   - [ ] 响应式设计适配不同屏幕尺寸
   - [ ] 移动端优化良好
   - [ ] 操作反馈及时清晰

### 7.2 技术验收

1. **响应式布局**
   - [ ] 在移动端（≤768px）显示正常
   - [ ] 在平板（769px-1024px）显示正常
   - [ ] 在桌面端（≥1025px）显示正常

2. **性能优化**
   - [ ] 初始加载时间≤2s
   - [ ] 展开/收起操作响应时间≤0.5s
   - [ ] 大数据量（1000+行）场景下性能良好

3. **兼容性**
   - [ ] 兼容现有系统的所有功能
   - [ ] 兼容现有用户数据
   - [ ] 支持主流浏览器

### 7.3 用户体验验收

1. **易用性**
   - [ ] 功能操作直观易懂
   - [ ] 界面简洁清晰
   - [ ] 操作流程顺畅

2. **视觉体验**
   - [ ] 界面美观，符合设计规范
   - [ ] 动画效果流畅自然
   - [ ] 视觉反馈及时

## 8. 实施计划

### 8.1 开发阶段

1. **需求分析与设计**：1个工作日
   - 细化功能需求
   - 设计UI界面
   - 制定技术方案

2. **前端开发**：3个工作日
   - 修改表格定义页面，替换"隐藏"为"下拉显示"
   - 修改数据管理页面，实现展开/收起功能
   - 添加动画效果
   - 实现响应式设计

3. **后端开发**：1个工作日
   - 确保数据持久化存储
   - 优化API性能

4. **测试与调试**：2个工作日
   - 功能测试
   - 兼容性测试
   - 性能测试
   - 修复bug

### 8.2 上线计划

1. **内部测试**：1个工作日
   - 邀请内部用户进行测试
   - 收集反馈并优化

2. **灰度发布**：1个工作日
   - 部分用户先行体验
   - 监控系统性能和用户反馈

3. **正式上线**：1个工作日
   - 全量发布
   - 持续监控系统运行状态

## 9. 风险评估

### 9.1 技术风险

- **风险**：现有数据兼容性问题
  - **应对策略**：确保后端数据结构兼容，前端做适配处理，不影响现有数据

- **风险**：性能问题，特别是大数据量场景
  - **应对策略**：采用虚拟滚动、懒加载等技术，优化DOM操作，确保性能良好

### 9.2 业务风险

- **风险**：用户习惯改变，可能需要适应期
  - **应对策略**：提供清晰的操作指引，优化UI设计，确保新功能直观易懂

- **风险**：功能变更可能影响现有业务流程
  - **应对策略**：保持核心功能不变，只优化交互体验，确保业务流程不受影响

## 10. 附录

### 10.1 术语表

- **下拉列**：指默认隐藏，需通过展开按钮显示的表格列
- **默认显示列**：指未勾选"下拉显示"复选框，默认在表格中显示的列
- **展开/收起**：指控制下拉列显示/隐藏的操作

### 10.2 参考文档

- 现有系统PRD文档
- Ant Design组件库文档
- 响应式设计最佳实践

### 10.3 相关页面

- 表格定义页面：`/src/pages/TableDefinition.jsx`
- 数据管理页面：`/src/pages/DataManagement.jsx`
- 组件文件：`/src/components/MultiSelectDelete.jsx`

### 10.4 设计稿

（此处可添加相关UI设计稿链接或截图）

---

**文档版本**：v1.0
**编写日期**：2025-12-08
**编写人**：产品文档团队
**审批人**：[审批人姓名]  
