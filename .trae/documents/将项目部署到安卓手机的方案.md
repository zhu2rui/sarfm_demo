# 将项目部署到安卓手机的方案

## 项目分析

这是一个基于 Flask + React 的前后端分离库存管理系统：
- 后端：Flask 应用，运行在 5000 端口，提供 API 服务和静态文件服务
- 前端：React + Vite 应用，构建后由后端提供服务
- 数据库：SQLite 数据库，存储在本地文件中

## 部署方案

### 方案一：使用 Termux 在安卓上直接运行 Python 代码

**优点**：
- 配置简单，不需要复杂的打包工具
- 可以直接运行源代码，方便调试和更新
- 支持热更新，适合开发阶段

**实施步骤**：

1. **在安卓手机上安装 Termux**
   - 从 F-Droid 或 Google Play 下载并安装 Termux
   - 打开 Termux 应用，执行初始化配置

2. **在 Termux 中安装必要的依赖**
   - 安装 Python：`pkg install python`
   - 安装 Git：`pkg install git`
   - 安装 Node.js（用于构建前端）：`pkg install nodejs`

3. **克隆项目代码**
   - 在 Termux 中创建工作目录：`mkdir -p ~/projects`
   - 进入工作目录：`cd ~/projects`
   - 克隆项目代码：`git clone <项目仓库地址>`

4. **配置后端环境**
   - 进入后端目录：`cd ~/projects/sarfm_demo/backend`
   - 安装 Python 依赖：`pip install -r requirements.txt`

5. **构建前端项目**
   - 进入前端目录：`cd ~/projects/sarfm_demo/frontend`
   - 安装 Node.js 依赖：`npm install`
   - 构建前端项目：`npm run build`
   - 将构建后的文件复制到后端目录：`cp -r dist/* ../backend/frontend_dist/`

6. **启动后端服务**
   - 进入后端目录：`cd ~/projects/sarfm_demo/backend`
   - 启动 Flask 应用：`python main.py`

7. **在浏览器中访问应用**
   - 查看安卓设备的 IP 地址：`ifconfig`（在 Termux 中执行）
   - 在浏览器中访问：`http://<安卓设备IP>:5000`

### 方案二：使用 PyInstaller 构建独立可执行文件

**优点**：
- 不需要在目标设备上安装 Python 环境
- 可以打包成单个可执行文件，方便分发
- 适合生产环境部署

**实施步骤**：

1. **在 Windows 机器上构建后端应用**
   - 进入后端目录：`cd sarfm_demo/backend`
   - 执行构建脚本：`python build_and_copy.py`
   - 构建完成后，可执行文件位于 `dist/InventoryManagementSystem/InventoryManagementSystem.exe`

2. **将构建后的文件复制到安卓设备**
   - 使用文件管理器将 `dist/InventoryManagementSystem` 目录复制到安卓设备
   - 确保文件权限正确

3. **在安卓设备上安装 Wine**
   - 在 Termux 中执行：`pkg install wine`

4. **使用 Wine 运行可执行文件**
   - 进入应用目录：`cd ~/Downloads/InventoryManagementSystem`
   - 运行可执行文件：`wine InventoryManagementSystem.exe`

5. **在浏览器中访问应用**
   - 查看安卓设备的 IP 地址：`ifconfig`（在 Termux 中执行）
   - 在浏览器中访问：`http://<安卓设备IP>:5000`

### 方案三：使用 Nginx + Gunicorn 部署

**优点**：
- 性能更好，适合高并发场景
- 支持负载均衡和反向代理
- 适合生产环境部署

**实施步骤**：

1. **在安卓手机上安装 Termux**（同上）

2. **安装必要的依赖**
   - 安装 Python 和 Git（同上）
   - 安装 Nginx：`pkg install nginx`
   - 安装 Gunicorn：`pip install gunicorn`

3. **克隆项目代码**（同上）

4. **配置后端环境**（同上）

5. **构建前端项目**（同上）

6. **配置 Nginx**
   - 创建 Nginx 配置文件：`nano ~/nginx.conf`
   - 配置反向代理和静态文件服务
   - 启动 Nginx：`nginx -c ~/nginx.conf`

7. **使用 Gunicorn 启动 Flask 应用**
   - 进入后端目录：`cd ~/projects/sarfm_demo/backend`
   - 启动 Gunicorn：`gunicorn -w 4 -b 0.0.0.0:5000 app:app`

8. **在浏览器中访问应用**（同上）

## 注意事项

1. **网络配置**
   - 确保安卓设备和访问设备在同一局域网内
   - 如果需要外部访问，需要配置端口映射或使用内网穿透工具

2. **性能优化**
   - 安卓设备的性能可能不如服务器，建议减少并发连接数
   - 可以考虑使用轻量级的 Web 服务器，如 uWSGI 或 Tornado

3. **数据安全**
   - SQLite 数据库文件需要定期备份
   - 建议使用 HTTPS 加密传输数据

4. **权限管理**
   - 确保应用程序有足够的权限访问文件系统
   - 定期更新依赖库，修复安全漏洞

## 推荐方案

考虑到安卓设备的特性和项目的复杂度，**方案一（使用 Termux 直接运行 Python 代码）**是最推荐的方案，因为它配置简单，不需要复杂的打包工具，适合快速部署和调试。

如果需要在生产环境中部署，可以考虑**方案三（使用 Nginx + Gunicorn 部署）**，它提供了更好的性能和可靠性。